            const groupedTasks = tasks.reduce((acc, task) => {
                acc[task.status] = acc[task.status] || [];
                acc[task.status].push(task);
                return acc;
            }, {});

            for (const status in statusTitles) {
                const list = groupedTasks[status] || [];
                message += `\n*${statusTitles[status]}* (${list.length})\n`;

                if (list.length > 0) {
                    list.forEach(task => {
                        const deadlineDate = task.deadline
                            ? new Date(task.deadline + 'T00:00:00').toLocaleDateString('pt-BR')
                            : 'Sem prazo';
                        message += `â€¢ ${task.title} (Prazo: ${deadlineDate}) - Resp: ${task.resp}\n`;
                    });
                } else {
                    message += `_Nenhuma tarefa nesta categoria._\n`;
                }
            }

            const encodedMessage = encodeWhatsApp(message);
            const whatsappURL = `https://wa.me/?text=${encodedMessage}`;
            window.open(whatsappURL, '_blank');
        } catch (e) {
            console.error("Erro ao exportar para WhatsApp: ", e);
            alert("Erro ao gerar o resumo para WhatsApp. Veja o console para detalhes.");
        }
    }
</script>

</body>
</html>
