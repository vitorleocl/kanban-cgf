<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kanban Board - Gestão de Atividades CGF</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: #f5f7fa;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .logo {
            max-width: 200px;
            height: auto;
            margin-bottom: 15px;
        }

        h1 {
            color: #2c3e50;
            font-size: 28px;
            margin: 0;
        }

        .export-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
        }

        .btn-export {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-pdf {
            background: #e74c3c;
            color: white;
        }

        .btn-whatsapp {
            background: #25D366;
            color: white;
        }

        .btn-export:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .kanban-board {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .kanban-column {
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            min-height: 500px;
        }

        .column-header {
            font-weight: bold;
            font-size: 16px;
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 15px;
            color: white;
            text-align: center;
        }

        .red { background: #e74c3c; }
        .yellow { background: #f39c12; }
        .blue { background: #3498db; }
        .green { background: #27ae60; }

        .task-card {
            background: white;
            border-left: 4px solid;
            border-radius: 6px;
            padding: 12px;
            margin-bottom: 12px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: move;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .task-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .task-card.red-border { border-left-color: #e74c3c; }
        .task-card.yellow-border { border-left-color: #f39c12; }
        .task-card.blue-border { border-left-color: #3498db; }
        .task-card.green-border { border-left-color: #27ae60; }

        .task-title {
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 8px;
            color: #2c3e50;
        }

        .task-description {
            font-size: 12px;
            color: #7f8c8d;
            margin-bottom: 10px;
            line-height: 1.4;
        }

        .task-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #ecf0f1;
        }

        .task-responsible {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }

        .responsible-tag {
            background: #ecf0f1;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 11px;
            color: #34495e;
        }

        .task-deadline {
            font-size: 11px;
            color: #e74c3c;
            font-weight: 600;
        }

        .add-task-btn {
            width: 100%;
            padding: 10px;
            background: #ecf0f1;
            border: 2px dashed #bdc3c7;
            border-radius: 6px;
            color: #7f8c8d;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .add-task-btn:hover {
            background: #d5dbdb;
            border-color: #95a5a6;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
        }

        .modal-content h2 {
            margin-bottom: 20px;
            color: #2c3e50;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #34495e;
            font-weight: 600;
            font-size: 14px;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: opacity 0.3s;
        }

        .btn:hover {
            opacity: 0.9;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .dragging {
            opacity: 0.5;
        }

        @media (max-width: 1024px) {
            .kanban-board {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 640px) {
            .kanban-board {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
 <img src="https://raw.githubusercontent.com/vitorleocl/kanban-cgf/main/logo-cgf.png" alt="CGF Logo" class="logo" id="cgfLogo">

            <h1>Kanban Board - Gestão de Atividades CGF</h1>
        </div>

        <div class="export-buttons">
            <button class="btn-export btn-pdf" onclick="exportToPDF()">
                📄 Exportar PDF
            </button>
            <button class="btn-export btn-whatsapp" onclick="exportToWhatsApp()">
                💬 Compartilhar WhatsApp
            </button>
        </div>
        
        <div class="kanban-board">
            <div class="kanban-column" data-status="todo">
                <div class="column-header red">A FAZER</div>
                <div class="task-list" id="todo-list">
                    <div class="task-card red-border" draggable="true">
                        <div class="task-title">Planejar nova campanha</div>
                        <div class="task-description">Desenvolver estratégia de marketing digital para o Q1 2026</div>
                        <div class="task-meta">
                            <div class="task-responsible">
                                <span class="responsible-tag">Ana Silva</span>
                                <span class="responsible-tag">Carlos Santos</span>
                            </div>
                            <div class="task-deadline">📅 15/10/2025</div>
                        </div>
                    </div>
                </div>
                <button class="add-task-btn" onclick="openModal('todo')">+ Adicionar Tarefa</button>
            </div>

            <div class="kanban-column" data-status="progress">
                <div class="column-header yellow">EM ANDAMENTO</div>
                <div class="task-list" id="progress-list">
                    <div class="task-card yellow-border" draggable="true">
                        <div class="task-title">Desenvolvimento do site</div>
                        <div class="task-description">Implementar novas funcionalidades na página inicial</div>
                        <div class="task-meta">
                            <div class="task-responsible">
                                <span class="responsible-tag">João Pedro</span>
                            </div>
                            <div class="task-deadline">📅 12/10/2025</div>
                        </div>
                    </div>
                </div>
                <button class="add-task-btn" onclick="openModal('progress')">+ Adicionar Tarefa</button>
            </div>

            <div class="kanban-column" data-status="review">
                <div class="column-header blue">EM REVISÃO</div>
                <div class="task-list" id="review-list">
                    <div class="task-card blue-border" draggable="true">
                        <div class="task-title">Relatório mensal</div>
                        <div class="task-description">Análise de métricas e KPIs do último mês</div>
                        <div class="task-meta">
                            <div class="task-responsible">
                                <span class="responsible-tag">Maria Oliveira</span>
                                <span class="responsible-tag">Pedro Costa</span>
                            </div>
                            <div class="task-deadline">📅 10/10/2025</div>
                        </div>
                    </div>
                </div>
                <button class="add-task-btn" onclick="openModal('review')">+ Adicionar Tarefa</button>
            </div>

            <div class="kanban-column" data-status="done">
                <div class="column-header green">CONCLUÍDO</div>
                <div class="task-list" id="done-list">
                    <div class="task-card green-border" draggable="true">
                        <div class="task-title">Design do logo</div>
                        <div class="task-description">Criação e aprovação do novo logo da empresa</div>
                        <div class="task-meta">
                            <div class="task-responsible">
                                <span class="responsible-tag">Lucas Ferreira</span>
                            </div>
                            <div class="task-deadline">📅 05/10/2025</div>
                        </div>
                    </div>
                </div>
                <button class="add-task-btn" onclick="openModal('done')">+ Adicionar Tarefa</button>
            </div>
        </div>
    </div>

    <div class="modal" id="taskModal">
        <div class="modal-content">
            <h2>Nova Tarefa</h2>
            <form id="taskForm">
                <div class="form-group">
                    <label>Título da Tarefa</label>
                    <input type="text" id="taskTitle" required>
                </div>
                <div class="form-group">
                    <label>Descrição / Comentários</label>
                    <textarea id="taskDescription"></textarea>
                </div>
                <div class="form-group">
                    <label>Responsáveis (separados por vírgula)</label>
                    <input type="text" id="taskResponsible" placeholder="Ex: Ana Silva, Carlos Santos">
                </div>
                <div class="form-group">
                    <label>Prazo</label>
                    <input type="date" id="taskDeadline">
                </div>
                <div class="form-group">
                    <label>Cor da Tarefa</label>
                    <select id="taskColor">
                        <option value="red">Vermelho (Urgente)</option>
                        <option value="yellow">Amarelo (Importante)</option>
                        <option value="blue">Azul (Normal)</option>
                        <option value="green">Verde (Baixa prioridade)</option>
                    </select>
                </div>
                <div class="button-group">
                    <button type="submit" class="btn btn-primary">Adicionar</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        let currentStatus = 'todo';
        let draggedElement = null;

        function openModal(status) {
            currentStatus = status;
            document.getElementById('taskModal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('taskModal').classList.remove('active');
            document.getElementById('taskForm').reset();
        }

        document.getElementById('taskForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const title = document.getElementById('taskTitle').value;
            const description = document.getElementById('taskDescription').value;
            const responsible = document.getElementById('taskResponsible').value;
            const deadline = document.getElementById('taskDeadline').value;
            const color = document.getElementById('taskColor').value;

            const taskCard = createTaskCard(title, description, responsible, deadline, color);
            
            const listId = currentStatus + '-list';
            document.getElementById(listId).appendChild(taskCard);
            
            closeModal();
        });

        function createTaskCard(title, description, responsible, deadline, color) {
            const card = document.createElement('div');
            card.className = `task-card ${color}-border`;
            card.draggable = true;
            
            const responsibleArray = responsible.split(',').map(r => r.trim()).filter(r => r);
            const responsibleTags = responsibleArray.map(r => 
                `<span class="responsible-tag">${r}</span>`
            ).join('');
            
            const formattedDate = deadline ? new Date(deadline).toLocaleDateString('pt-BR') : '';
            
            card.innerHTML = `
                <div class="task-title">${title}</div>
                <div class="task-description">${description}</div>
                <div class="task-meta">
                    <div class="task-responsible">
                        ${responsibleTags}
                    </div>
                    ${formattedDate ? `<div class="task-deadline">📅 ${formattedDate}</div>` : ''}
                </div>
            `;
            
            setupDragAndDrop(card);
            return card;
        }

        function setupDragAndDrop(card) {
            card.addEventListener('dragstart', function() {
                draggedElement = this;
                this.classList.add('dragging');
            });

            card.addEventListener('dragend', function() {
                this.classList.remove('dragging');
            });
        }

        document.querySelectorAll('.task-list').forEach(list => {
            list.addEventListener('dragover', function(e) {
                e.preventDefault();
            });

            list.addEventListener('drop', function(e) {
                e.preventDefault();
                if (draggedElement) {
                    this.appendChild(draggedElement);
                }
            });
        });

        document.querySelectorAll('.task-card').forEach(card => {
            setupDragAndDrop(card);
        });

        // Carregar logo CGF
        window.addEventListener('DOMContentLoaded', function() {
            const logoImg = document.getElementById('cgfLogo');
            // A logo será carregada a partir do arquivo enviado
            // Por enquanto, vamos usar um canvas para desenhar a logo baseada na imagem
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = 400;
            canvas.height = 250;
            
            // Fundo transparente
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Círculos verdes de fundo (engrenagens)
            ctx.fillStyle = 'rgba(84, 160, 85, 0.3)';
            ctx.beginPath();
            ctx.arc(120, 100, 60, 0, Math.PI * 2);
            ctx.fill();
            ctx.beginPath();
            ctx.arc(280, 100, 60, 0, Math.PI * 2);
            ctx.fill();
            
            // Pistões (esquerdo)
            ctx.fillStyle = '#455A64';
            ctx.beginPath();
            ctx.arc(100, 60, 18, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillRect(91, 60, 18, 45);
            ctx.beginPath();
            ctx.arc(100, 105, 10, 0, Math.PI * 2);
            ctx.fill();
            
            // Pistões (direito)
            ctx.beginPath();
            ctx.arc(300, 60, 18, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillRect(291, 60, 18, 45);
            ctx.beginPath();
            ctx.arc(300, 105, 10, 0, Math.PI * 2);
            ctx.fill();
            
            // Gota d'água azul (centro)
            const gradient = ctx.createLinearGradient(180, 50, 220, 120);
            gradient.addColorStop(0, '#2196F3');
            gradient.addColorStop(1, '#1976D2');
            ctx.fillStyle = gradient;
            ctx.beginPath();
            ctx.moveTo(200, 50);
            ctx.quadraticCurveTo(220, 70, 220, 90);
            ctx.quadraticCurveTo(220, 110, 200, 120);
            ctx.quadraticCurveTo(180, 110, 180, 90);
            ctx.quadraticCurveTo(180, 70, 200, 50);
            ctx.fill();
            
            // Reflexo na gota
            ctx.fillStyle = 'rgba(255, 255, 255, 0.4)';
            ctx.beginPath();
            ctx.ellipse(195, 75, 8, 12, 0, 0, Math.PI * 2);
            ctx.fill();
            
            // Engrenagens
            ctx.strokeStyle = '#455A64';
            ctx.lineWidth = 8;
            ctx.fillStyle = 'rgba(84, 160, 85, 0.6)';
            
            // Engrenagem esquerda
            for(let i = 0; i < 6; i++) {
                const angle = (i * Math.PI * 2) / 6;
                ctx.save();
                ctx.translate(120, 100);
                ctx.rotate(angle);
                ctx.fillRect(-8, -50, 16, 20);
                ctx.restore();
            }
            ctx.beginPath();
            ctx.arc(120, 100, 30, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();
            
            // Engrenagem direita
            for(let i = 0; i < 6; i++) {
                const angle = (i * Math.PI * 2) / 6;
                ctx.save();
                ctx.translate(280, 100);
                ctx.rotate(angle);
                ctx.fillRect(-8, -50, 16, 20);
                ctx.restore();
            }
            ctx.beginPath();
            ctx.arc(280, 100, 30, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();
            
            // Texto CGF
            ctx.fillStyle = '#263238';
            ctx.font = 'bold 48px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('CGF', 200, 180);
            
            ctx.fillStyle = '#546E7A';
            ctx.font = '14px Arial';
            ctx.fillText('COORDENAÇÃO DE GESTÃO DE FROTAS', 200, 200);
            
            // Aplicar canvas como imagem
            logoImg.src = 'logo-cgf.png';
            logoImg.style.display = 'block';
        });

        window.onclick = function(e) {
            const modal = document.getElementById('taskModal');
            if (e.target === modal) {
                closeModal();
            }
        }

        function getAllTasks() {
            const tasks = {
                todo: [],
                progress: [],
                review: [],
                done: []
            };

            Object.keys(tasks).forEach(status => {
                const listId = status + '-list';
                const cards = document.querySelectorAll(`#${listId} .task-card`);
                
                cards.forEach(card => {
                    const title = card.querySelector('.task-title').textContent;
                    const description = card.querySelector('.task-description').textContent;
                    const responsibleTags = card.querySelectorAll('.responsible-tag');
                    const responsible = Array.from(responsibleTags).map(tag => tag.textContent).join(', ');
                    const deadlineEl = card.querySelector('.task-deadline');
                    const deadline = deadlineEl ? deadlineEl.textContent.replace('📅 ', '') : 'Sem prazo';

                    tasks[status].push({
                        title,
                        description,
                        responsible,
                        deadline
                    });
                });
            });

            return tasks;
        }

        function exportToPDF() {
            const tasks = getAllTasks();
            const date = new Date().toLocaleDateString('pt-BR');
            
            let content = `
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <title>Relatório Kanban - CGF</title>
                    <style>
                        body { font-family: Arial; padding: 40px; }
                        .header { text-align: center; margin-bottom: 30px; }
                        h1 { color: #2c3e50; }
                        .date { color: #7f8c8d; margin-top: 10px; }
                        .section { margin: 30px 0; page-break-inside: avoid; }
                        .section-title { 
                            padding: 10px; 
                            color: white; 
                            font-weight: bold; 
                            border-radius: 5px;
                            margin-bottom: 15px;
                        }
                        .red { background: #e74c3c; }
                        .yellow { background: #f39c12; }
                        .blue { background: #3498db; }
                        .green { background: #27ae60; }
                        .task { 
                            background: #f8f9fa; 
                            padding: 15px; 
                            margin: 10px 0; 
                            border-left: 4px solid;
                            border-radius: 5px;
                        }
                        .task.red-border { border-left-color: #e74c3c; }
                        .task.yellow-border { border-left-color: #f39c12; }
                        .task.blue-border { border-left-color: #3498db; }
                        .task.green-border { border-left-color: #27ae60; }
                        .task-title { font-weight: bold; margin-bottom: 8px; }
                        .task-meta { font-size: 12px; color: #7f8c8d; margin-top: 8px; }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>📋 Relatório Kanban - Gestão de Atividades CGF</h1>
                        <div class="date">Gerado em: ${date}</div>
                    </div>
            `;

            const sections = [
                { key: 'todo', title: 'A FAZER', color: 'red', border: 'red-border' },
                { key: 'progress', title: 'EM ANDAMENTO', color: 'yellow', border: 'yellow-border' },
                { key: 'review', title: 'EM REVISÃO', color: 'blue', border: 'blue-border' },
                { key: 'done', title: 'CONCLUÍDO', color: 'green', border: 'green-border' }
            ];

            sections.forEach(section => {
                content += `<div class="section">`;
                content += `<div class="section-title ${section.color}">${section.title} (${tasks[section.key].length})</div>`;
                
                if (tasks[section.key].length === 0) {
                    content += `<p style="color: #7f8c8d; font-style: italic;">Nenhuma tarefa</p>`;
                } else {
                    tasks[section.key].forEach(task => {
                        content += `
                            <div class="task ${section.border}">
                                <div class="task-title">${task.title}</div>
                                <div>${task.description}</div>
                                <div class="task-meta">
                                    👤 ${task.responsible} | 📅 ${task.deadline}
                                </div>
                            </div>
                        `;
                    });
                }
                content += `</div>`;
            });

            content += `</body></html>`;

            const printWindow = window.open('', '_blank');
            printWindow.document.write(content);
            printWindow.document.close();
            
            setTimeout(() => {
                printWindow.print();
            }, 250);
        }

        function exportToWhatsApp() {
            const tasks = getAllTasks();
            const date = new Date().toLocaleDateString('pt-BR');
            
            let message = `*📋 KANBAN - GESTÃO DE ATIVIDADES CGF*\n`;
            message += `_Atualizado em: ${date}_\n\n`;

            const sections = [
                { key: 'todo', title: '🔴 A FAZER', emoji: '⏳' },
                { key: 'progress', title: '🟡 EM ANDAMENTO', emoji: '⚙️' },
                { key: 'review', title: '🔵 EM REVISÃO', emoji: '🔍' },
                { key: 'done', title: '🟢 CONCLUÍDO', emoji: '✅' }
            ];

            sections.forEach(section => {
                message += `\n*${section.title}* (${tasks[section.key].length})\n`;
                message += `${'─'.repeat(30)}\n`;
                
                if (tasks[section.key].length === 0) {
                    message += `_Nenhuma tarefa_\n`;
                } else {
                    tasks[section.key].forEach((task, index) => {
                        message += `\n${section.emoji} *${task.title}*\n`;
                        message += `${task.description}\n`;
                        message += `👤 ${task.responsible}\n`;
                        message += `📅 ${task.deadline}\n`;
                    });
                }
            });

            message += `\n\n_Relatório gerado automaticamente pelo Sistema Kanban CGF_`;

            const encodedMessage = encodeURIComponent(message);
            window.open(`https://wa.me/?text=${encodedMessage}`, '_blank');
        }
    </script>
</body>
</html>
